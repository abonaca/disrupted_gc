\documentclass[twocolumn]{aastex63}

% typography
\usepackage[T1]{fontenc}

\setlength{\parindent}{1.\baselineskip}
\newcommand{\acronym}[1]{{\small{#1}}}
\newcommand{\package}[1]{\textsl{#1}}
\newcommand{\gaia}{\textsl{Gaia}}
% \newcommand{\hst}{\textsl{HST}}
% \newcommand{\pans}{\textsl{Pan-STARRS}}

% \newcommand{\deg}{\ensuremath{\textrm{deg}}}
\newcommand{\msun}{\ensuremath{\textrm{M}_\odot}}
\newcommand{\myr}{\ensuremath{\textrm{Myr}}}
\newcommand{\gyr}{\ensuremath{\textrm{Gyr}}}
\newcommand{\kpc}{\ensuremath{\textrm{kpc}}}
\newcommand{\kms}{\ensuremath{\textrm{km}\,\textrm{s}^{-1}}}
\newcommand{\masyr}{\ensuremath{\textrm{mas}\,\textrm{yr}^{-1}}}
\newcommand{\feh}{\ensuremath{\textrm{[Fe/H]}}}
\newcommand{\afe}{\ensuremath{\textrm{[$\alpha$/Fe]}}}
\newcommand{\changes}[1]{{\textbf{#1}}}
\hyphenation{kruijs-sen}

% aastex parameters
% \received{not yet; THIS IS A DRAFT}
%\revised{not yet}
%\accepted{not yet}
% % Adds "Submitted to " the argument.
% \submitjournal{ApJ}
\shorttitle{}
\shortauthors{bonaca \& kruijssen}

%@arxiver{}
\usepackage{amsmath}

\begin{document}\sloppy\sloppypar\raggedbottom\frenchspacing % trust me

\title{The Progenitor Globular Clusters of Stellar Streams in the Galactic Halo}

\correspondingauthor{Ana~Bonaca}
\email{ana.bonaca@cfa.harvard.edu}

\author[0000-0002-7846-9787]{Ana~Bonaca}
\affil{Center for Astrophysics | Harvard \& Smithsonian, 60 Garden Street, Cambridge, MA 02138, USA}

\author[0000-0002-8804-0212]{J.~M.~Diederik~Kruijssen}
\affiliation{Astronomisches Rechen-Institut, Zentrum f\" ur Astronomie der Universit\" at Heidelberg, M\" onchhofstra\ss e 12-14, D-69120 Heidelberg, Germany}
\affil{Center for Astrophysics | Harvard \& Smithsonian, 60 Garden Street, Cambridge, MA 02138, USA}


\begin{abstract}\noindent % trust me
We present orbits and masses of 22 thin stellar streams in the Milky Way.
We constrained the streams' orbits by fitting the combined 5D phase-space of sky positions, distances and proper motions, including radial velocities where available.
% 3D positions of a stream's endpoints from ground-based photometry and its proper motions from Gaia.
Assuming that the streams are globular clusters which dissolved in 10\,Gyr, we used orbital apocenters and eccentricities to estimate their pre-evaporation masses.
Fossil streams follow a similar distribution of orbital apocenters and eccentricities as the surviving globular clusters, however, their pre-evaporation masses are an order of magnitude lower, with a median of $8.5\times10^3\,\msun$.
The progenitors of tidal streams observed at the present are a specific, low-mass subset of the initial globular cluster population.
Building on these findings, we conclude that (1) globular clusters represent the high-mass end of a broader initial cluster population extending into the low-mass regime of clusters observed to form today,
(2) the internal dynamics plausibly had a limited role in sculpting the observed density variations in streams such that external perturbations (e.g., from dark-matter subhalos) are required, and
(3) the lowest metallicity stellar streams may have constituted a significant fraction of their host galaxy's mass at the time of their formation.
% establishing the role of internal dynamics in sculpting the observed tidal debris, and the amount of external perturbation, e.g., from dark-matter subhalos, that these streams experienced.
\end{abstract}

\section{Introduction}
\label{sec:intro}

Unveiling the origin of the ancient globular clusters remains a major challenge in modern astrophysics \citep[e.g.][]{brodie:2006,kruijssen:2014,forbes:2018,adamo:2020}.
Broadly speaking, the field is divided into two families of models.
The first interprets globular clusters as the products of unique conditions that exist mostly or exclusively in the early Universe \citep[e.g.][]{peebles:1968,fall:1985,ashman:1992,trenti:2015,madau:2020}.
In recent years, a second interpretation has been gaining traction, which is that globular clusters are the natural outcome of regular star formation in normal high-redshift galaxies \citep[e.g.][]{kravtsov:2005,kruijssen15b,pfeffer:2018,keller:2020}.
Both scenarios predict vastly different globular cluster formation histories at high redshifts.
Most globular clusters are old ($\gtrsim10$~Gyr) and their ages are notoriously imprecise, but demographics of young proto-globular clusters observed directly at high redshift could potentially distinguish between these ideas (e.g., with the upcoming \textit{James Webb Space Telescope}, JWST).
% Because globular cluster ages are notoriously imprecise at the old ages of most globular clusters ($\gtrsim10$~Gyr), direct observations of the demographics of young proto-globular clusters with the \textit{James Webb Space Telescope} (JWST) could potentially distinguish between both ideas.
However, this experiment is greatly complicated by the fact that the current population of globular clusters represents the `tip of the iceberg' that survived nearly a Hubble time of dynamical evolution and disruption.
It is not clear how to connect the current globular cluster population to the initial one.

Theoretical studies of the dynamics of globular clusters orbiting in the Galactic halo predict that stars escape globular clusters due to two-body relaxation and tidal stripping \citep[often referred to as `evaporation', e.g.,][]{spitzer:1987, baumgardt03}, forming long and thin tidal tails along the cluster's orbit \citep{combes:1999}.
Such tidal tails were first detected around the Palomar~5 globular cluster \citep{odenkirchen:2001, rockosi:2002}.
Stellar streams of similar width and length, but without a surviving progenitor, have been discovered throughout the Milky Way \citep[e.g.,][]{gd:2006, grillmair:2009, bonaca:2012, shipp:2018, ibata:2019}.
Measurements of a small metallicity dispersion in some of these streams indicate that they likely constitute a population of completely dissolved globular clusters \citep{bonaca:2020b, hansen:2020, ji:2020}.
% Of which at least part likely constitutes a population of completely dissolved globular clusters.

The two families of globular cluster formation models predict qualitatively different initial globular cluster mass functions.
Reconstructing masses of stellar stream progenitors at the onset of the evaporation process that led to their dissolution would help distinguish these formation channels.
Models relying on unique, early-universe conditions often predict that globular clusters are born with a characteristic mass scale related to the conditions of their formation \citep[e.g.][]{peebles:1968,fall:1985,trenti:2015,madau:2020}.
This translates into the characteristic mass scale of $\sim10^5~\msun$ observed in the present-day globular clusters without requiring prevalent disruption.
In this family of models, one would expect the masses of fossil stream progenitors to be similar to those of globular clusters.


% It is unknown what the progenitors were of the population of stellar streams in the Galactic halo, but reconstructing their initial properties (or at least those prior to the evaporation process that led to their dissolution in the halo) would greatly aid predictions for the properties of the initial globular cluster population.
% It would also help distinguish between the aforementioned two families of globular cluster formation models, which predict qualitatively different initial globular cluster mass functions.
% Models relying on unique, early-Universe conditions often predict that globular clusters are born with a characteristic mass scale related to the conditions of their formation \citep[e.g.][]{peebles:1968,fall:1985,trenti:2015,madau:2020}, which then translates into the characteristic mass scale of $\sim10^5~\msun$ observed at the present day without requiring prevalent globular cluster disruption.
% In this family of models, one would expect the masses of fossil stream progenitors to be similar to those of globular clusters.


By contrast, models that describe globular clusters as the outcomes of regular star and cluster formation generally assume that their initial mass distribution followed a power law with an index around $-2$, mirroring observations of young cluster populations in the local Universe \citep[e.g.,][]{larsen:2009,adamo:2020}.
This power law mass distribution then evolves into the current, peaked form by dynamical disruption of low-mass clusters due to early tidal perturbations in the natal galaxy and subsequent evaporation in the halo \citep{elmegreen:1997,fall:2001,elmegreen:2010,kruijssen15b}.
This scenario predicts the existence of a population of low-mass clusters that vanished by dynamical disruption.
Because globular cluster disruption proceeds more rapidly at low masses \citep{baumgardt03,krumholz:2019}, the progenitor clusters of stellar streams may have been part of this putative low-mass cluster population.
In this family of models, one would expect the masses of fossil stream progenitors to be lower than those of globular clusters.

Our goal in this paper is to dynamically estimate masses of disrupted globular clusters that are now observed as stellar streams in the Milky Way, under the assumption that the streams result from disrupted clusters rather than dwarf galaxies.
The timescale for cluster disruption is determined by its initial mass, i.e.\ more massive clusters survive over longer timescales, and its orbit, i.e.\ clusters on more eccentric orbits and with smaller apocenters dissolve faster \citep{baumgardt03,kruijssen09}.
Velocities are essential for accurately estimating the streams' orbits \citep{bh:2018}, and thanks to Gaia proper motions \citep{gdr2}, there are now 22 stellar streams with known kinematics.
In Section~\ref{sec:orbits} we use the observed positions and motions of stream stars to determine their orbits.
Since the streams are coherent, we assume the progenitor globular clusters disrupted recently \citep{helmi:2003}, and in Section~\ref{sec:disrupted} calculate their pre-evaporation masses.
We place this population of disrupted globular clusters in the context of cluster (\S\,\ref{sec:discuss_gcform}) and galaxy formation (\S\,\ref{sec:discuss_galform}), and discuss the implications of the inferred low masses in the context of stellar streams as tracers of dark matter in the Milky Way (\S\,\ref{sec:discuss_dynamics}).

% As described above, a mass function that includes disrupted globular clusters can determine whether globular clusters are a product of regular star formation or whether they require unique conditions to form.
% In addition, measuring masses of stream progenitors will further constrain their role in the early galaxy formation, as well as improve dynamical modeling of the streams' evolution in the Milky Way.
% 
% The paper is organized as follows.


% \begin{deluxetable*}{l @{\hspace{0.5cm}} D D D D D D @{\hspace{0.8cm}} D D D}
% \tablehead{
% Name & \multicolumn2c{R.A.} & \multicolumn2c{Dec} & \multicolumn2c{d} & \multicolumn2c{$\mu_\alpha$} & \multicolumn2c{$\mu_\delta$} & \multicolumn2c{$V_r$} & \multicolumn2c{$r_{peri}$} & \multicolumn2c{$r_{apo}$} & \multicolumn2c{$\log M_0/\rm\msun$}\\
% & \multicolumn2c{deg} & \multicolumn2c{deg} & \multicolumn2c{kpc} & \multicolumn2c{mas/yr} & \multicolumn2c{mas/yr} & \multicolumn2c{km/s} & \multicolumn2c{kpc} & \multicolumn2c{kpc} & \multicolumn2c{dex}
% }
% \decimals
% \setlength{\tabcolsep}{3pt}
% \startdata
% \input{table_properties.tex}
% \enddata
% \caption{Dynamical properties of stellar streams, with the stream name and the fiducial right ascension in the first two columns, respectively.
% Columns~$3-7$ are our estimates for the fiducial phase-space coordinates of the stream's orbit.
% The final three columns provide constraints on the orbital pericenter, apocenter, and the pre-evaporation mass of the stream's progenitor.
% The quoted values are the medians, while the uncertainties reflect the $16-84$ percentiles of the posterior distributions.
% }
% \label{table:constraints}
% \end{deluxetable*}


\section{Stream Orbits}
\label{sec:orbits}

Several dozen of thin stellar streams, likely disrupted globular clusters, have been reported in the Milky Way \citep[an up-to-date list is available in the \package{galstreams} package,][]{mateu:2018}.
Because kinematic information is essential for accurate stream modeling \citep{bh:2018}, here we limit our analysis to 22 stellar streams with published proper motions.

Tidal debris from evaporating globular clusters nearly delineates the progenitor's orbit \citep[e.g.,][]{kupper:2012}.
We use the observed sky positions, distances, proper motions, and, where available, radial velocities to find the streams' orbits.
Member stars have been identified along most streams in our sample, so for those we use their phase-space coordinates directly.
For the most diffuse streams (Ravi, Turbio, Wambelong, and Willka-Yaku), only average distances and proper motions are available \citep{shipp:2019}, so we distribute 20 control points between these streams' endpoints \citep{riley:2020}, and assume that distance and proper motion are constant along the stream.
The complete provenance of the original measurements is described in Appendix~\ref{sec:appendix} and summarized in Table~\ref{table:phasespace}.
All of the data points we used to fit are available in the project repository\footnote{\url{https://github.com/abonaca/disrupted_gc}}).
% \footnote{\url{https://github.com/abonaca/disrupted_gc/tree/master/data/streams}}.
On the left side of Figure~\ref{fig:streams} we show (from the top) the observed sky positions, distances, and components of the proper motion vector for the Fj\" orm stream as orange points.
The interactive version of this Figure contains a gallery of all the streams in our sample and is available in the online version of this article, and here.

% We measure orbital parameters for a population of dissolved globular clusters by fitting orbits to sky positions, distances, and proper motions of stream endpoints.
% Due to limited observational data on some streams, we decided to fit only the stream endpoints to ensure a homogeneous treatment of the entire sample.
% \citet{riley:2020} demonstrated that the 3D positions of stream end-points robustly constrain their orbital poles, while \citet{ibata:2019} found that the absence of radial velocities produces no significant biases in orbit determination for streams with proper motion data.
% Therefore, we expect our strategy of recovering orbits from 5D positions of stream endpoints to perform well.
% In Section~\ref{sec:discussion} we discuss how orbital constraints change for streams where additional data is available.
% The endpoint sky positions and distances \citep{riley:2020}, and proper motions \citep[][as noted]{ibata:2019, shipp:2019} are listed in Table~\ref{table:constraints}, along with the associated uncertainties.
% Figure~\ref{fig:streams} shows these data for three representative streams as large orange points (top to bottom: x, y, z).

\begin{figure*}
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/stream_fitting.pdf}
\end{center}
\caption{Orbital constraints for the Fj\"{o}rm stellar stream in the observed coordinates (left: panels from top to bottom show declination, distance, and proper motion components as a function of right ascension) and cylindrical Galactocentric coordinates (right: in and out of the Galactic plane for the top and bottom panels, respectively).
Different shades of blue represent orbit samples from the posterior constrained by the stream observations (orange points).
Current observations allow for a range of orbital apocenters and eccentricities.
}
\label{fig:streams}
\end{figure*}

\begin{deluxetable}{l @{\hspace{0.5cm}} D D D}
\tablehead{
Name & \multicolumn2c{$r_{peri}$} & \multicolumn2c{$r_{apo}$} & \multicolumn2c{$\log M_0/\rm\msun$}\\
& \multicolumn2c{kpc} & \multicolumn2c{kpc} & \multicolumn2c{dex}
}
\decimals
\setlength{\tabcolsep}{3pt}
\startdata
\input{table_properties.tex}
\enddata
\caption{Derived properties of stellar streams: orbital pericenter, apocenter and the pre-evaporation mass of the stream's progenitor.
Quoted values are the medians of the sampled posterior distributions and the uncertainties reflect their $16-84$ percentiles.
}
\label{table:constraints}
\end{deluxetable}

We fit stream orbits in a three-component model of the Milky Way's gravitational potential implemented in the \package{gala} package \citep{gala} and featuring a \citet{mn:1975} disk (mass: $5.5\times10^{10}\rm\, M_\odot$, scale-length: 3\,kpc, scale-height: 28\,pc), a \citet{hernquist:1990} bulge (mass: $4\times10^9\rm\, M_\odot$, scale-radius: 1\,kpc), and a \citet{nfw:1997} halo (scale-mass: $7\times10^{11}\rm\, M_\odot$, scale-radius: 15.62\,kpc, $z$-axis flattening: 0.95).
To estimate the systematic uncertainty in derived orbital parameters and initial progenitor masses, we also constrain orbits in a slightly less massive \texttt{MWPotential2014} gravitational potential \citep{bovy:2015} and a somewhat more massive potential used in \citet{pwb}.
In detail, the Galactic gravitational potential is perturbed by the Large and Small Magellanic Clouds, and the Sagittarius dwarf galaxy \citep{gomez:2015, erkal:2019, vasiliev:2020}.
However, most of the streams in our sample have been orbiting in the inner Galaxy, where the impact of these massive satellites is less prominent \citep{petersen:2020} and the assumption of a static gravitational potential introduces biases in the recovery of orbital apocenters on the order of only $\approx10\%$ \citep{garrow:2020}.


Individual stellar streams can be well represented by a single orbit \citep[e.g.,][]{koposov:2010, pwb, ibata:2019}.
However, as stars escape from a globular cluster through its Lagrange points, their orbits differ from the cluster's \citep{eyre:2011}.
This orbital misalignment can be forward modeled \citep{varghese:2011, bonaca:2014, sanders:2014}, but this is computationally involved, so we leave it to future work and proceed with the more tractable orbit-fitting.
We follow \citet{pwb} and represent the orbit as a 6D location in phase-space, fixing its right ascension, R.A., and solving for the remaining five coordinates (declination, distance, radial velocity, two proper motion components).
At the R.A. of the stream measurements, we evaluate the orbital declinations, distances, proper motions, and radial velocities (where available) against the observations, assuming Gaussian uncertainties.
The orbits are initialized close to a stream's endpoint such that the trial orbit passes close to the observed data points.
To prefer bound solutions, we employ a weak prior by requiring the absolute radial velocity lower than 500\,\kms.

We begin the search for well-fitting stream orbits by maximizing the likelihood of orbits passing through the observed streams using the \package{scipy} implementation of the BFGS algorithm.
Focusing on this best-fitting solution, we further sample the phase-space parameters with an affine-invariant sampler \package{emcee} to estimate the posterior distribution of the orbital parameters.
We advanced 64 walkers for 512 steps and kept the last 256 steps, which converged to constant median and dispersion values for all model parameters.
The median, 16th and 84th percentiles of the constrained 5D coordinates are reported for each stream's orbit in the Appendix~\ref{sec:appendix} (Table~\ref{table:phase-space}).

To visualize and further explore the streams' orbits, we randomly sampled 1,000 points from the posterior distributions of every stream (available at the project repository).
% \footnote{\url{https://github.com/abonaca/disrupted_gc}}).
First, we integrated short orbital segments starting from these initial positions, and plot them as blue lines in the observable coordinates in Figure~\ref{fig:streams} (different shades of blue correspond to different samples from the posterior distribution).
For all of the streams we recovered a class of orbital solutions that fits the observed streams, with the allowed spread set by the observational uncertainties.
For streams without radial velocities, we predict the radial velocity gradients along the stream.
In case of Fj\" orm, radial velocities with $\approx1$\,\kms uncertainties are needed to further constrain its orbit (bottom left panel of Figure~\ref{fig:streams}).

Next, we performed 5\,Gyr-long orbit integrations starting from the same initial positions to estimate constraints on the orbital pericenter, $r_{peri}$, apocenter, $r_{apo}$, and eccentricity, $e=(r_{apo} - r_{peri})/(r_{apo} + r_{peri})$.
These longer orbits are shown in Galactocentric coordinates on the right side of Figure~\ref{fig:streams} (in-plane $x-y$ at the top, and cylindrical $\rho-z$ at the bottom).
We report the median, 16th and 84th percentiles of the streams' pericenters and apocenters in Table~\ref{table:constraints}.
The extensive observational data puts strong constraints on the streams' orbits, and the typical uncertainty in the peri- and apocenters is $\lesssim1\,\kpc$.
Across the board, pericenters are measured more precisely than apocenters, with the typical uncertainty of 3\% compared to 6\%, respectively.
This is also visible in the top right panel of Figure~\ref{fig:streams}, where different orbital solutions for the  Fj\" orm stream are cospatial at the pericenter, but fanned out at the apocenter.
Comparing orbits derived in alternate Milky Way models, we detect no biases in pericenters, but apocenters are on average 10\% larger in the light model and 10\% smaller in the heavy model.
These systematic biases are larger than individual uncertainties, underscoring the importance of analyzing all streams self-consistently in the same potential.
In the next section we use these orbital constraints to estimate the initial masses of the progenitor globular clusters.

\section{Masses of disrupted globular clusters}
\label{sec:disrupted}

\subsection{Method for inferring pre-evaporation globular cluster masses}
We estimate the masses of the globular clusters producing the streams using a simple analytic globular cluster disruption model \citep{lamers05}, which reproduces direct $N$-body simulations of globular clusters undergoing tidal evaporation in a static background potential \citep{baumgardt03}. Specifically, we obtain a `pre-evaporation' globular cluster mass $M_0$ by estimating the total mass loss due to stellar evolution and tidal evaporation for a cluster on the inferred orbit over some timescale $\Delta t$. We refrain from deriving an `initial' globular cluster mass, because tidal evaporation in the host galaxy halo is not the only mass loss mechanism experienced by globular clusters over the course of their history, yet it is the only mechanism that we can `rewind' using the current orbital information. Prior to being deposited into the halo, globular clusters were disrupted by tidal shocks due to gravitational perturbations from overdensities in the interstellar medium of their natal galaxy \citep[e.g.][]{gieles06,elmegreen:2010b,kruijssen11,miholics17,pfeffer:2018}. Integrated over the history of globular clusters, tidal shocks are thought to dominate the total dynamical mass loss \citep[e.g.][]{kruijssen15b}. Therefore, the quantity $M_0$ refers strictly to the `pre-evaporation' globular cluster mass -- after the first phase of disruption tidal shocks, but before the second phase of disruption by tidal evaporation. We also include the total amount of mass lost by stellar evolution, so that only the mass loss by tidal shocks is unaccounted for.

We relate $M_0$ to the orbit of the stellar stream by assuming a present-day globular cluster mass of zero (consistent with the fact that only a fossil stream remains) and writing eq.~7 of \citet{lamers05} as
\begin{equation}
\label{eq:m0}
M_{\rm 0}=\frac{1}{\mu_{\rm ev}(\Delta t)}\left(\frac{\gamma \Delta t}{t_0}\right)^{1/\gamma} .
\end{equation}
In this expression, $\mu_{\rm ev}(t)$ is the fraction of the initial globular cluster mass lost by stellar evolution, provided by \citet{lamers05} as
\begin{equation}
\label{eq:muev}
\mu_{\rm ev}(\Delta t)=1-q_{\rm ev}(\Delta t) ,
\end{equation}
with
\begin{equation}
\label{eq:qev}
\log_{10}{q_{\rm ev}}(\Delta t) = [\log_{10}(\Delta t/{\rm yr})-a_{\rm ev}]^{b_{\rm ev}}+c_{\rm ev} ,
\end{equation}
and $a_{\rm ev} = 6.93$, $b_{\rm ev} = 0.255$, and $c_{\rm ev} = -1.682$, appropriate for a globular cluster-like metallicity of $0.02{\rm Z}_\odot$ and a \citet{kroupa01} stellar initial mass function \citep{kruijssen08}. The variables $\gamma$ and $t_0$ represent the exponent and proportionality factor, respectively, of the Lamers cluster disruption law:
\begin{equation}
\label{eq:lamers}
\tau_{\rm dis}=t_0\left(\frac{M}{\msun}\right)^\gamma ,
\end{equation}
where $\tau_{\rm dis}$ is the cluster disruption timescale. We follow \citet{kruijssen09} and \citet{lamers:2010} in adopting $\gamma=0.7$ and relating $t_0$ to the orbital parameters as
\begin{equation}
\label{eq:t0}
t_0 = t_{0,\odot}\left(\frac{R_{\rm a}}{8.5~\kpc}\right)\left(\frac{v_{\rm c}}{220~\kms}\right)^{-1}(1-e) ,
\end{equation}
with $t_{0,\odot}=10.7~\myr$ and $R_{\rm a}$, $v_{\rm c}$, and $e$ denoting the orbital apocenter radius, circular velocity, and orbital eccentricity, respectively. Finally, we assume that the time spent by each globular cluster orbiting the Milky Way prior to dissolving into a fossil stream is $\Delta t=10~\gyr$. This is motivated by the typical ages of globular clusters in the Galactic halo \citep[$\sim12~\gyr$, e.g.][]{kruijssen19e} and by the fact that the fossil stream phase space density drops precipitously with age \citep{helmi:1999}, such that the progenitors of fossil streams must have disrupted in the past few Gyr. Our results are robust to this choice -- an error of 0.3~dex (i.e.\ a factor of 2) in $\Delta t$ translates into an error of 0.4~dex in the pre-evaporation mass $M_0$. This is the most extreme case -- in practice, we expect a systematic uncertainty due to globular cluster ages and stream lifetimes of about 0.1~dex, which we add to the formal uncertainties of all pre-evaporation masses.

\begin{figure*}
\includegraphics[width=\hsize]{figures/distributions_mc.pdf}%
\caption{
\label{fig:hist}
Demographics of fossil streams (and their progenitor clusters) compared to those of the Galactic globular cluster population. Left: Apocenter radius distributions. The gray-shaded area indicates the inner radii ($\leq10$~kpc) where few fossil streams are found. In the middle and right panels, we therefore consider the globular clusters outside of these radii. Middle: Orbital eccentricity distributions. globular clusters have a weak excess of high eccentricities relative to fossil streams. Right: Mass distributions, both for current globular clusters and for the masses of fossil streams and globular clusters after rewinding their evaporation-driven mass loss in the Galactic halo. The progenitors of fossil streams were systematically a factor of $>10$ less massive than globular clusters.}
\end{figure*}

\subsection{Comparison between fossil stream pre-evaporation masses and those of surviving globular clusters}
We propagate the uncertainties on the fossil streams' orbital parameters into those on the pre-evaporation masses by applying eq.~(\ref{eq:m0}) to the entire sample of MCMC solutions. The resulting distributions of all apocenter radii, eccentricities, and pre-evaporation masses of the fossil streams in the MCMC sample are shown in \autoref{fig:hist}, where we also include the population statistics of Galactic globular clusters that have survived till the present day \citep[2010 edition]{harris96}. For these surviving globular clusters, we also include an estimate of their pre-evaporation masses.

\autoref{fig:hist} reveals interesting differences between the demographics of fossil streams and globular clusters. First, there is a distinct dearth of streams with apocenter radii $\leq10$~kpc. We attribute this to incompleteness, as it is more challenging to identify streams within the solar circle. Additionally, streams may have short lifetimes at small radii due to their short orbital periods. For this reason, we exclude globular clusters with apocenter radii $\leq10$~kpc in the subsequent panels. At larger radii, the streams follow approximately the same apocenter radius distribution as globular clusters, even if there may be a deficit of streams with apocenter radii $\geq60$~kpc. This could again be related to completeness, because the photometric and kinematic detection of streams is more challenging at larger distances. Second, we find that the eccentricity distribution of streams falls well below the distribution of globular clusters at large eccentricities. This result is somewhat counterintuitive, because globular clusters on eccentric orbits are expected to be disrupted more rapidly (see equation~\ref{eq:t0}). Rather than being the result of cluster disruption, we expect the difference in eccentricity distributions to result from the rapid disruption of fossil streams on plunging, eccentric orbits. A strongly decreased lifetime of streams with high eccentricities could naturally produce the observed difference.

Finally, and most interestingly, the pre-evaporation masses of fossil streams and globular clusters differ significantly. The median pre-evaporation mass of fossil streams is just $8.5\times10^3~\msun$, compared to $5\times10^5~\msun$ for globular clusters (and $1.5\times10^5~\msun$ for the current globular cluster masses). This factor-of-60 difference in pre-evaporation mass directly reflects the fundamentally different nature of both classes of objects. Globular clusters must have had the right properties to enable their survival over nearly a Hubble time, whereas fossil streams were disrupted by definition. Since the orbital distributions only show mild differences when limiting the sample to apocenter radii $>10$~kpc, the pre-evaporation mass determines almost entirely whether a cluster survives as a globular cluster or results in a fossil stream.

\begin{figure*}
\includegraphics[width=\hsize]{figures/distributions_2d_mc.pdf}%
\caption{
\label{fig:kde}
Two-dimensional demographics of fossil streams progenitors compared to those of the Galactic globular cluster population. Top left: Mass-apocenter radius plane. Bottom left: Mass-eccentricity plane. Bottom right: Apocenter radius-eccentricity plane. In each panel, the contours show a two-dimensional Gaussian kernel density estimate for the fossil stream progenitors, using the complete sample of MCMC realizations. Blue symbols show the best-fitting result for each fossil stream. Open black symbols show current globular clusters, whereas filled black symbols show their pre-evaporation masses, i.e.\ those corrected for evaporation-driven mass loss on their current orbits. In each panel, the gray-shaded band shows the range in each panel that is predicted to be occupied by the fossil stream progenitors assuming 10~Gyr of evolution, given their range of best-fitting orbital properties and progenitor masses (indicated by the annotations in gray). The fossil stream progenitors are clearly offset from the globular clusters, especially in terms of their pre-evaporation masses (shown in the left-hand panels).}
\end{figure*}

\autoref{fig:kde} shows the two-dimensional projections of the same quantities as in \autoref{fig:hist}, together with the region within which clusters are predicted to be disrupted within 10~Gyr for the observed stream properties.
As expected, the streams fall within this region, which is systematically offset from the distributions of globular clusters, irrespectively of whether we adopt current or pre-evaporation globular cluster masses.
Stream progenitors had lower masses (which is necessary to end up as a stream at the present day), have somewhat lower eccentricities (because streams with high eccentricities are disrupted at pericenter), and occupied larger radii (because streams at small radii are difficult to observe and may survive less long).
Interestingly, the difference in apocenter radii manifests itself most strongly at low eccentricities.
It is well known that the orbits of globular clusters become radially anisotropic towards larger radii \citep[e.g.][]{dinescu99}, and the bottom right panel of Figure~\ref{fig:kde} shows that globular clusters with small apocenters have smaller eccentricities than those with large apocenters.
In contrast, there are barely any low-eccentricity fossil streams with small apocenters.
We expect this difference to be driven by the lack of searches for stellar streams towards the Galactic center \citep[e.g.,][]{malhan:2018, ibata:2019}, and faster disruption of stellar streams in the inner Galaxy \citep[e.g., due to enhanced dispersal caused by the rotating bar,][]{price-whelan:2016, hattori:2016}.
% and the fossil streams do not follow the same behaviour.
% We expect this difference to be driven by a combination of incompleteness of the stream sample and stream survival.
% {\color{red}Ana, thoughts?}
Finally, the top-left panel of \autoref{fig:kde} shows that the lack of streams with small apocenter radii limits their possible pre-evaporation masses to $<3\times10^5~\msun$. However, this is not responsible for the mass offset that we find. Even when extrapolating the expected distribution of the stream sample along the gray band to same range of apocenter radii as globular clusters, the pre-evaporation masses remain about an order of magnitude lower than those of globular clusters.


\section{Summary and Discussion}
\label{sec:discussion}

We determined orbits of 22 disrupted Milky Way satellites by fitting sky positions, distances, and proper motions of the remnant stellar streams.
Assuming that the progenitors are globular clusters which dissolved recently, we integrated the orbit-dependent mass-loss rate to infer their pre-evaporation masses.
Surprisingly, the orbital distribution of disrupted globular clusters, in particular their apocenters and eccentricities, is similar to the orbital properties of the surviving population.
On the other hand, the inferred masses of disrupted globular clusters peak at $8.5\times10^3\,\msun$---an order of magnitude lower than the mass of a typical globular cluster in the Milky Way today.
In this section we discuss the implications of this population of low-mass, disrupted globular clusters on the proposed mechanisms of globular cluster formation (\S\,\ref{sec:discuss_gcform}), on the dynamics of stellar streams (\S\,\ref{sec:discuss_dynamics}), and on the formation of early galaxies (\S\,\ref{sec:discuss_galform}).

\subsection{Formation mechanism of globular clusters}
\label{sec:discuss_gcform}
Most processes that destroy globular clusters operate more efficiently closer to the Galactic center \citep[e.g.,][]{gnedin:1997}.
Hence, if the initial population of globular clusters sampled the orbital space uniformly, we might expect to preferentially find stellar streams on more eccentric orbits with smaller apocenters.
However, streams from our sample occupy similar orbital families as the present-day globular clusters, and the main difference between the two populations is the lower average mass of disrupted clusters.
% explain more
This may indicate that most globular clusters that ever orbited the Milky Way can be associated with a handful of its progenitor galaxies, in agreement with the phase-space \citep{massari:2019} and age-metallicity \citep{kruijssen19e,kruijssen20} distributions of the surviving cluster population.
Partly, streams with small apocenters and those with high eccentricities may be missing from our sample due to observational biases: low eccentricity tidal debris is more readily identifiable as a thin stellar stream \citep{hendel:2015}, while searching for streams in the inner Galaxy is challenging due to high contamination from the field Milky Way stars \citep[e.g.,][]{ibata:2019}.
The wealth of observational data expected over the next decade will allow for a more complete census of stellar streams that can further test the emerging picture in which the initial population of Galactic globular clusters originates from a small number of host galaxies.

Low-mass clusters are more susceptible to disruption \citep[e.g.,][]{fall:2001,kruijssen15b}.
As a result, globular clusters, which are predominantly old, peak at a characteristic mass of $\approx10^5\,\msun$ \citep[e.g.,][]{harris:1991}, whereas the masses of young clusters follow a power law distribution \citep[e.g.,][]{zhang:1999}.
As expected for disrupted globular clusters, we find that the masses of stellar stream progenitors are lower than those of still bound clusters.
However, the combined distribution of pre-evaporation masses for stream progenitors and surviving clusters is much shallower than the initial cluster mass function.
In part, the comparative dearth of low-mass clusters may be attributed to incompleteness in the stream sample and the finite lifetimes of the streams, but it may also signify that evaporation is a subdominant cluster disruption mechanism.
For example, \citet{kruijssen15b} proposed that most early-forming clusters were rapidly disrupted in the turbulent disks of their host galaxies, and that only a small fraction of the initial cluster population survives long enough to experience evaporation.
A complete census of stellar streams could therefore inform on dynamical properties of star-forming galaxies at high redshift.


\begin{figure*}
\includegraphics[width=\hsize]{figures/streams_peri_apo.pdf}
\caption{
Left: Apocenter versus pericenter of stellar streams' orbits, with the marker size corresponding to the stream's pre-evaporation mass and its color to the angular momentum $L_z$ (orange for prograde, purple for retrograde orbits).
Present-day streams that have been orbiting in stronger tidal fields are preferentially more massive.
Similarity in orbital pericenters, apocenters, and angular momenta indicate that some streams might be dynamically associated.
Right: Stellar streams are also associated with the present-day globular clusters, many of which have already been associated with the most massive Milky Way progenitors (different symbols).
}
\label{fig:individual_summary}
\end{figure*}

\subsection{Dynamics of stellar streams}
\label{sec:discuss_dynamics}
Stellar streams are dynamical tracers of 
- streams dynamical tracers of the mw environment
- knowing masses useful because:
% Globular cluster dynamics are set by its mass, and consequently, 
- total mass can tell us if we've seen the whole stream
- total mass determines the overdensities
- we discuss these here

Orbital properties of individual streams in our sample are summarized in Figure~\ref{fig:individual_summary}, which shows their apocenters versus pericenters, with errorbars enclosing the $16-84$ percentiles of the uncertainty range.
Dashed lines trace orbits with the same eccentricity.
Stream markers are colored by the $z$-component of their orbital angular momenta, $L_z$, with orange for prograde ($L_z<0$), purple for retrograde ($L_z>0$), and white for radial orbits ($L_z\approx0$).
Larger symbols correspond to more massive progenitors.
% In the remainder of this section we discuss how derived orbits and masses inform the orbital histories of individual stellar streams in the Milky Way.
In general, we infer higher masses for disrupted clusters that have orbited in stronger tidal fields: at a fixed eccentricity, streams on orbits with smaller apocenters have more massive progenitors.
Similarly, for a given apocenter radius, streams on more eccentric orbits have more massive progenitors.
The strong correlation between derived stream orbits and the initial cluster masses is set in part because we assumed that all clusters have been dissolving for the same amount of time.
Future independent constraints on the streams' dynamical ages, for example from their phase-space dispersal \citep{buckley:2019},  would modulate this behavior.
% -- add reference to erkal's method in the intro (2016a,b -- rough bc assumes circular)

Stellar streams may extend beyond their current detection limits at a lower surface brightness, so if they truly are disrupted globular clusters, we expect their cumulative stellar masses to be lower than the pre-evaporation progenitor masses we derived here.
However, the pre-evaporation masses of three streams in our sample (Elqui, Indus, and Jhelum) are an order of magnitude lower than their directly measured stellar masses \citep{shipp:2018}.
Recently, high-resolution spectroscopy showed these streams have abundance spreads consistent with low-mass dwarf galaxies \citep{ji:2020}, indicating that inferring a pre-evaporation mass lower than the observed stream mass means the stream is a disrupted dwarf galaxy rather than a globular cluster.
On the other hand, a pre-evaporation mass much larger than the detected stream stellar mass indicates significant portions of the debris remain undiscovered.
In the inner Galaxy, the high pre-evaporation masses of diffuse and short streams like Fimbulthul and Ophiuchus may signal enhanced dispersal of tidal debris, for example, due to the dynamical influence of the rotating Galactic bar \citep{hattori:2016, price-whelan:2016}.
In the outer Galaxy, however, we also find that the pre-evaporation masses of Phoenix and Wambelong are $\approx2.5$ and $10$ times larger than their respective stellar masses \citep{shipp:2018}.
According to our orbital constraints, these streams are close to their apocenter, so the missing stellar mass is likely due to observational limitations, and may be recovered in deeper data.
Finally, the directly measured stellar masses of the following streams agree well with the pre-evaporation masses we inferred, indicating they have been mapped in full: the Aliqa Uma--ATLAS complex, Ravi, Turbio, Turranburra, and Willka Yaku.
Our assurance that the entire system has been observed will aid the construction of dynamical models that reproduce the observed streams.

Finally, we examine how the inferred progenitor masses affect stellar streams as detectors of dark-matter substructure.
Numerical simulations show that a low-mass dark-matter subhalo encountering a stellar stream can kinematically heat the stream and produce an under-density (gap) at the location of closest approach \citep[e.g.,][]{johnston:2002, ibata:2002, carlberg:2009, yoon:2011, erkal:2015}.
However, patterns of under- and over-densities naturally arise in stellar streams due to epicyclic pile-ups of stars \citep[e.g.,][]{kupper:2008, just:2009, kupper:2010}.
Recently, density variations were discovered in the GD-1 stream \citep{pwb, deboer:2020}, and both external perturbation \citep{bonaca:2019b, banik:2019} and epicycles \citep{ibata:2020} have been invoked as their origin.
More massive globular clusters imprint stronger epicyclic variations, so an accurate accounting of the stream progenitor's mass would constrain the amount of density variation that can be attributed to epicycles.
We find that the GD-1 progenitor of $\approx7\times10^3\,\msun$ was slightly less massive than assumed in modeling so far ($7\times10^4\,\msun$ by \citealt{bonaca:2019b}, and $3\times10^4\,\msun$ by \citealt{ibata:2020}).
Our measurements of pre-evaporation masses provide an opportunity to construct more realistic models of streams like the GD-1, and ultimately put more stringent limits on the abundance of dark-matter subhalos in the Milky Way.


\subsection{Associations between stellar streams}
\label{sec:discuss_associations}
Interestingly, Figure~\ref{fig:individual_summary} shows that several groups of streams have similar pericenters, apocenters, and angular momenta.
Different streams can have similar orbits because: (1) they were originally part of the same stream, as recently reported for ATLAS and Aliqa Uma \citep{li:2020}, or (2) they were accreted in the same host dwarf galaxy, as suggested for GD-1 and Kshir \citep{malhan:2019}.
In our sample, ATLAS and Aliqa Uma have the most similar orbits, and their combined stellar mass agrees well with the pre-evaporation mass we inferred for their respective progenitors, adding further evidence they are debris from the same globular cluster progenitor.
- orbital similarity of sylgr, ravi -> peri and apo?

Very retrograde and with large apocenters, $\approx45\,\kpc$, Turbio and Willka-Yaku form a loose group, as do GD-1, Phoenix, and Ylgr at smaller apocenters, $\approx20\,\kpc$, and more mildly retrograde orbits.
These groups are more likely to be evidence of group infall.
Another stream, Hermus (not included in our analysis due to the lack of proper motions), may be associated with the latter group, as \citet{grillmair:2016} showed that in projection it lies close to the orbit of the Phoenix stream.

- globular clusters added: positions from baumgardt
- associations from kruijssen, massari
- some stream-cluster pairs very close
- gjoll same chemistry, although far away -> likely same system
- other pair similarly close: ophiuchus ngc 288, 

- 

Chemical abundances and improved proper motions from future Gaia data releases and orbit integrations in more realistic, time-dependent Milky Way models \citep[e.g., those that self-consistently include Large Magellanic Cloud and Sagittarius,][]{petersen:2020, garavito-camargo:2020, vasiliev:2020} will test the nature of these stream associations.

\begin{figure}
\includegraphics[width=\hsize]{figures/mhost_fraction.pdf}
\caption{
\label{fig:mhost}
Mass fraction of the natal galaxy constituted by the progenitors of fossil streams (blue) and low-metallicity globular clusters (black) as a function of the galaxy mass.
% The sample is restricted to fossil streams with known metallicities, which are converted to a natal galaxy mass using the galaxy mass-metallicity relation between $z=3$ and $z=6$.
Error bars combine metallicity uncertainties with the evolution of the mass-metallicity relation across this redshift range.
On average, stream progenitors constituted a smaller fraction of their natal galaxy's mass than globular clusters, but the progenitors of the most metal-poor streams likely represented a significant fraction of the lowest-mass galaxies ever to exist.
}
\end{figure}

\subsection{Early galaxy formation}
\label{sec:discuss_galform}
We can place the pre-evaporation masses of the progenitor clusters in the context of their natal galaxy by assuming that at birth they had the same metallicity as their host galaxy, and using the metallicity of the stream to infer the galaxy mass at the time of cluster formation \citep{kruijssen20b}. This is possible, because the galaxy mass-metallicity relation is predicted to exhibit little evolution over the formation redshift range of the metal-poor clusters considered here, such that the stream metallicity mostly traces the natal galaxy mass, rather than the formation redshift. Metallicities are available for nine of the streams in our sample (Aliqa Uma, ATLAS, Fj\"orm, GD-1, Ophiuchus, Phoenix, Slidr, Sylgr, and Ylgr; \citealt{ibata:2019,li:2020,wan20}). We follow \citet{kruijssen19c} and convert these metallicities to natal galaxy masses using the galaxy mass-metallicity relation between $z=3$ and $z=6$ predicted by the FIRE simulations \citep{ma16}.

\autoref{fig:mhost} shows the resulting relation between the galaxy mass fraction constituted by the stream progenitor clusters (using their pre-evaporation masses) and the natal galaxy mass. For comparison, we are also including the ten GCs with metallicities $[{\rm Fe}/{\rm H}]<-2$ from the compilation of \citet{kruijssen19e}. The ranges of pre-evaporation masses of streams ($10^{3.7}{-}10^{4.5}~\msun$) and globular clusters ($10^{4.6}{-}10^{6.3}~\msun$) are each considerably narrower than the total range of natal galaxy masses ($10^{4.8}{-}10^{8.0}~\msun$). As a result, the galaxy mass fraction constituted at birth is controlled primarily by the natal galaxy mass, such that the fraction decreases with galaxy mass and metallicity. The typical mass fraction constituted by stream progenitors must have been of the order $10^{-3}$ (due to their low masses), whereas it was typically a few percent for the metal-poor GCs considered here. The two very most metal-poor GCs (NGC~6341 and NGC~7078) may have constituted anywhere between 10--100\% of their host galaxies.

Due to the narrow range of stream masses, their metallicity is a strong predictor for the galaxy mass fraction they constituted at birth. The highest fractions are also found at the lowest metallicities. The recently-measured metallicity of the Phoenix stream \citep{wan20} implies that its progenitor cluster represented $3.3_{-2.1}^{+5.7}$\% of its host galaxy at formation, whereas we estimate that the progenitor of the extremely metal-poor Sylgr stream \citep{ibata:2019,roederer:2019} represented $16_{-10}^{+27}$\% of its host galaxy. This is means that the progenitors of fossil streams below the GC `metallicity floor' \citep{beasley:2019,kruijssen19c} of $[{\rm Fe}/{\rm H}]\approx-2.5$ (or equivalently in galaxies with stellar masses $\la10^6~\msun$) may have represented a relevant fraction of the host galaxy mass, ranging anywhere from 1--100\%. Individual stream progenitors of such high masses may have had a profound impact on the early formation of the host galaxy and potentially its reionization. In future observations of galaxies with stellar masses $\la10^6~\msun$ with the JWST, such progenitor clusters should manifest themselves as bright knots. These systems should not survive as GCs, because they would fall below the GC metallicity floor observed at $z=0$, but they are potential stream progenitors. Such high-redshift observations would directly connect the galactic archaeological results presented in this paper to direct observations of the young stellar systems in their birth environments.

%- what were they in the context of the host galaxy
%- under the assumption that at birth they clusters had the same metallicity as the ambient galaxy, estimate its mass from mass-metallicity relation (cite).
%% The sample is restricted to fossil streams with known metallicities, which are converted to a natal galaxy mass using the galaxy mass-metallicity relation between $z=3$ and $z=6$.
%metallicities available for a subset of streams (cite), shown in blue in figure~\ref{fig:mhost}
%Error bars combine metallicity uncertainties with the evolution of the mass-metallicity relation across this redshift range.
%- as a comparison, low-metallicity globular clusters are shown in black
%- don't expect bound clusters to be dominant mode of sf -- even the more massive gc only contribute 1\% to 30\%
%- the streams have lower mass, so most contribute even less
%- however: some streams lower metallicity, therefore originating from a lower mass galaxy
%- there it dominated the stellar mass budget, and might have had a profound impact on the early formation (keep the galaxy reionized for a while)
%- could be just stochasticity: extending this analysis to more streams will show how common this scenario is
%
%- after fig 4: make prediction for jwst
%- if jwst sees below mstar<~1e6Msun, you see bright knots -- not a surviving gc, but a stream progenitor
%-- explore puny mass range




\vspace{0.5cm}
It is a pleasure to thank: Charlie Conroy.
J.M.D.K.\ gratefully acknowledges the generous hospitality of the Institute for Theory and Computation at Harvard University, where this work was instigated and part of it was carried out. J.M.D.K.\ gratefully acknowledges funding from the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) through an Emmy Noether Research Group (grant number KR4801/1-1) and the DFG Sachbeihilfe (grant number KR4801/2-1), as well as from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation programme via the ERC Starting Grant MUSTANG (grant agreement number 714907).

\software{
\package{Astropy} \citep{astropy, astropy:2018},
\package{gala} \citep{gala},
\package{IPython} \citep{ipython},
\package{matplotlib} \citep{mpl},
\package{numpy} \citep{numpy},
\package{scipy} \citep{scipy}
}

\appendix
\section{Stream data origin}
\label{sec:appendix}

\bibliographystyle{aasjournal}
\bibliography{disrupted_gc}


\end{document}


